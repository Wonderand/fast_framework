$(function () {    $("#ofdGrid").jqGrid({        url: 'sys/file/ofdlist',        datatype: "json",        colModel: [            {label: '文件名', name: 'tableName', width: 100, key: true},            {label: '文件大小', name: 'tableSize', width: 100},            {label: '上传时间', name: 'createTime', width: 100},            {                label: '操作',                name: 'actions', width: 100,                formatter: function (cellvalue, options, rowObject) {                    var previewLink = "/ofd/ofdjs/index.html?file=" + rowObject.id; // 你可以根据需要修改这里的值                    // var deleteLink = rowObject.tableName; // 你可以根据需要修改这里的值                    var deleteLink = "/ofd/sys/file/delete/" + rowObject.id; // 你可以根据需要修改这里的值                    return '<a target="_blank" href="' + previewLink + '" class="btn btn-info"><i class="fa fa-eye"></i>&nbsp;查看</a>|<a class="btn btn-danger" onclick="deleteFileRow(event, ' + rowObject.id + ')"><i class="fa fa-trash"></i>&nbsp;删除</a>';                }            },        ],        viewrecords: true,        height: 385,        rowNum: 10,        rowList: [10, 30, 50, 100, 200],        rownumbers: true,        rownumWidth: 25,        autowidth: true,        multiselect: true,        pager: "#ofdGridPager",        jsonReader: {            root: "page.list",            page: "page.currPage",            total: "page.totalPage",            records: "page.totalCount"        },        prmNames: {            page: "page",            rows: "limit",            order: "order"        },        gridComplete: function () {            //隐藏grid底部滚动条            $("#ofdGrid").closest(".ui-jqgrid-bdiv").css({"overflow-x": "hidden"});        }    });});var vm = new Vue({    el: '#ofd',    data: {        q: {            tableName: null        }    },    methods: {        query: function () {            $("#ofdGrid").jqGrid('setGridParam', {                postData: {'tableName': vm.q.tableName},                page: 1            }).trigger("reloadGrid");        },        generator: function () {            var tableNames = getSelectedRows();            if (tableNames == null) {                return;            }            location.href = "sys/generator/code?tables=" + tableNames.join();        }    }});$('.custom-file-input').on('change', function () {    let fileName = $(this).val().split('\\').pop();    $(this).next('.custom-file-label').addClass("selected").html(fileName);});$(document).ready(function () {    $('#uploadForm').submit(function (e) {        e.preventDefault();        // 获取文件        const file = $('#fileInput')[0].files[0];        // 创建 FormData 对象        const formData = new FormData();        formData.append('file', file);        // 发送文件上传请求        $.ajax({            url: '/ofd/sys/file/upload', // 上传 URL            type: 'POST',            data: formData,            processData: false,            contentType: false,            // xhr: function () {            //     const xhr = new window.XMLHttpRequest();            //     xhr.upload.addEventListener('progress', function (e) {            //         if (e.lengthComputable) {            //             const percent = (e.loaded / e.total) * 100;            //             $('.progress-bar').css('width', percent + '%').attr('aria-valuenow', percent);            //         }            //     });            //     return xhr;            // },            success: function (response) {                // 上传成功后的处理                // $('.progress').hide();                alert(response.msg);                vm.query();            },            error: function () {                // 上传失败的处理                alert('文件上传失败，请重试。');            }        });    });});var btn = document.getElementById("uploadbtn");document.getElementById("fileInput").onchange = function () {    btn.click();}var add_file = document.getElementById("add_file");add_file.onclick = function () {    document.getElementById("fileInput").click();}deleteFileRow = function (event, id) {    event.preventDefault();    var data ={        "id":id    }    var jsonString = JSON.stringify(data);    $.ajax({        url: "/ofd/sys/file/delete/",        type: 'POST',        data: jsonString,        contentType: 'application/json; charset=UTF-8',        success: function (r) {            vm.query();            alert('删除成功');        }    });}